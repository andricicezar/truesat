This repository contains the source code of TrueSAT, a SAT solver implementing the DPLL algorithm that is fully verified in Dafny. It also contains a C# and a C++ solver for comparison.

### Requirements
Tested with Dafny 3.6.0.40511.

### Folder structure

* folder `bench` - benchmarking infrastructure and results

    * `*.csv` - the running times that we have obtained in our run of the benchmark;

    * `*.gp` - GNUPLOT files (based on quantile.gp, distributed with benchexec);

    * folder `results` - folder with the results generated by benchexec in our run of the benchmark;

    * `quantile-generator.py` - file from benchexec used for preparing `.csv`s for gnuplot;

    * `download-tests.py` - download the SAT tasks and preprocess them;

    * `Makefile` - goals for benchmarking each tool, generating plots, etc (you will need to update the paths to match your system);

    * folder `tests` - the DIMACS files with the SAT tasks go here;

    * folder `truesat-bench` - benchexec plugins for the SAT solvers that we use.

* `cpp_solver` - C++ implementation of a DPLL SAT Solver

Run `make build` to create the executable file `dpllcpp` (you need a modern C++ compiler, such as g++).

Run `dpllcpp <file.cnf>` (a DIMACS file) to run the solver on a satisfiability task.

* `csharp_solver` - C# implementation of a DPLL SAT Solver

Run `make build` to create the executable file `dpll.exe` (you need a C# compiler, such as `csc` offered by `Mono`).

Run `dpll.exe <file.cnf>` (a DIMACS file) to run the solver on a satisfiability task.

* `truesat_src` - Dafny source code of TrueSAT

Run `make verify` to verify the Dafny development against the specification (takes about 5 minutes single-threaded). By default there are 8 threads.

Run `make build` to extract the C# code from the Dafny code.

Run `csc -r:System.Numerics.dll,System.Collections.Immutable.dll truesat.cs file_input.cs` to compile the C# code.

(If necessary:) Run `chmod a+x truesat.exe` to make it executable.

Run `truesat.exe <file.cnf>` (a DIMACS file) to run the solver on a satisfiability task.

Run `statistics.sh` to generate statistics of the Dafny development.

* `truesatbig_src` - Dafny source code of TrueSAT modified so that literals and variables are represented as BigIntegers (for benchmarking purposes)

The same commands as above should be used.

### Benchmark

You can download test files from this [website](https://www.cs.ubc.ca/~hoos/SATLIB/benchm.html)
or use our script `bench/download-tests.py`.

We used the tool [`bench-exec`](https://github.com/sosy-lab/benchexec) to run our benchmarks.

#### Instalation
Please check the [documentation of `bench-exec`](https://github.com/sosy-lab/benchexec)
to see how to install it.

#### Prepare
1. Compile any of the solvers you would like to bench.
2. Go into the `bench/truesat-bench` and run the command:
`python3 -m pip install . --upgrade`.
3. In the `bench` folder run `python3 download-tests.py`.

#### Running tests
You can run the benchmarks for the dafny solver by using the make command.
Please open it, and fix the paths to the solvers. After that, you can run
`make bench_truesat`.

### Contributors
* Cezar C. Andrici, Alexandru Ioan Cuza University of Iasi, Romania
* Stefan Ciobaca, Alexandru Ioan Cuza University of Iasi, Romania
